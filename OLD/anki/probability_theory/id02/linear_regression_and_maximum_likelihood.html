<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../../../dist/CSS/anki_style.css" />
    <script type="text/javascript" charset="utf-8" src="../../../dist/JS/jQuery321.js"></script>
    <link rel="stylesheet" type="text/css" href="../../../dist/CSS/normalize.css" />
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/dreampulse/computer-modern-web-font/master/fonts.css"> -->

    <title>Probability Theory (02): Linear Regression and Maximum Likelihood</title>
  </head>

  <body>
    <div id="st-container" class="st-container">
        <nav class="st-menu st-effect-11" id="menu-11">
            <h2 class="icon icon-lab"><b>Decks</b></h2>
            <ul>
                <li><a href="https://borea17.github.io/anki/probability_theory/id00/introduction"
                       class="navigationLink">Probability Theory</a></li>
                <li><a href="https://borea17.github.io/anki/reinforcement_learning/id00/introduction"
                       class="navigationLink">Reinforcement Learning</a></li>
                <li><a href="https://borea17.github.io/anki/deep_learning/id00/introduction"
                       class="navigationLink">Deep Learning</a></li>
                <li><a href="https://borea17.github.io/anki/causality/id00/introduction"
                       class="navigationLink">Causality</a></li>
            </ul>
        </nav>

        <!-- content push wrapper -->
        <div class="st-pusher">
            <div class="st-content">
                <!-- this is the wrapper for the content -->
                <div class="st-content-inner">
                    <!-- extra div for emulating position:fixed of the menu -->
                    <!-- Top Navigation -->
                    <div class="codrops-top clearfix">
                          <div id="st-trigger-effects">
                            <span class="left">
                              <a href="https://borea17.github.io">
                                &#8962; Home
                              </a>
                            </span>
                            <button class="buttonClass" id="sideBarButton"
                                    data-effect="st-effect-11">
                              Change Deck
                            </button>
                            <span class="right">
                              <a href="https://borea17.github.io/about">
                                About
                              </a>
                            </span>
                          </div>
                    </div>
                    <div class="header">
                        <h2 style="margin-left:10vw">PROBABILITY THEORY</h2>
                    </div>

                    <div class="flex-container">
                      <!-- Question Box -->
                      <div class="outer-box">
                        <div class="box">
                            <div class="text" >
                                How are <b>linear regression</b> and <b>maximum likelihood</b>
                                connected? Why does it make sense to use the <b>method of least squares</b>
                                from a probabilistic point of view in linear regression?
                            </div>
                        </div>
                      </div>
                      <!-- Answer Box -->
                      <div class="outer-box" id="answer">
                          <div class="answer-box">
                              <div class="text" >
                                  Under the assumption that the data is generated from a linear function with
                                  independent and identical ($\sigma$ constant) Gaussian noise ($\nu \sim \mathcal{N} (0, \sigma^2)$)
                                  the <b>negative log-likelihood</b> is proportional to the squared sum of the residuals, i.e.,
                                  <b>minimizing the negative log-likelihood (maximizing the log-likelihood) leads to the same solution
                                  as the least squares method</b>.
                                  <br>
                                  <br>
                                  <b>Derivation:</b><br>
                                  Given a dataset $\mathcal{D} = \{(\textbf{x}_1, y_1), \dots, (\textbf{x}_N, y_N)\}$ and the
                                  <b>model assumption</b>:                                 $$
                                      y_i = \textbf{w}^{\text{T}} \textbf{x}_i + \beta + \nu_i \quad \quad \nu \sim \mathcal{N}(0, \sigma^2)
                                  $$
                                  the parameters of the model are $\theta = (\textbf{w}, \beta, \sigma^{2})$. In terms of <b>maximum likelihood</b>,
                                  we want to maximize:
                                  $$
                                  p(\mathcal{D} | \theta) =
                                  p (\textbf{x}_1) \cdot p(y_1| \textbf{x}_1; \theta) \cdot ... \cdot p(\textbf{x}_N| \textbf{x}_1, \dots,
                                  \textbf{x}_{N-1}) \cdot p(y_N| \textbf{x}_N; \theta)=
                                  p_X (\textbf{x}_1, \dots, \textbf{x}_N) \prod_{i=1}^N p(y_i | \textbf{x}_i; \theta)
                                  $$
                                  where the density $p_X$ is unknown and independent of $\theta$. Given our model assumption, we can write
                                  $$
                                  p(y_i|\textbf{x}_i, \theta)  \sim
                                  \mathcal{N} \left(\textbf{w}^{\text{T}} \textbf{x}_i + \beta, \sigma^2  \right) = \frac {1}{\sqrt{2\pi \sigma^2}}
                                  \exp\left( - \frac {(y_i - \textbf{w}^{\text{T}} \textbf{x}_i - \beta)^2} {\sigma^2} \right)
                                  $$
                                  Thus, we get for the <b>negative log-likelihood</b>
                                  $$
                                  -\ln p(\mathcal{D}|\theta) = \sum_{i=1}^N \frac {1}{2} \log \big(2 \pi \sigma^2 \big) + \frac {1}{2\sigma^2}
                                  \big(y_i - \textbf{w}^{\text{T}} \textbf{x}_i - \beta \big)^2 \propto
                                  \sum_{i=1}^N \big(y_i - \textbf{w}^{\text{T}} \textbf{x}_i - \beta \big)^2
                                  $$
                                  This is the result which is stated above. For a more detailed derivation, see
                                  <a style="color:blue" href="http://www.d2l.ai/chapter_linear-networks/linear-regression.html">d2l.ai</a>.
                                  Note that in linear regression, we do not intent to estimate $\sigma^2$. However, it may be helpful since
                                  a large variance indicates that our linear regression model will produce highly biased estimates. 
                              </div>
                          </div>
                      </div>
                      <!-- Button -->
                      <button onclick="show_hide_answer()" id="show_answer_button">Show Answer</button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script src="../../../dist/JS/classie.js"></script>
    <script type="text/javascript" src="../../../dist/JS/sidebar.js"></script>
    <script type="text/javascript" src="../all_slides.js"></script>
    <script>
      function show_hide_answer() {
          var x = document.getElementById("answer");
         var button = document.getElementById("show_answer_button"); 
         if (x.style.display === "none") {
            x.style.display = "block";
            button.innerHTML = "Hide Answer";
         } else {
            x.style.display = "none";
            button.innerHTML = "Show Answer";
         }
      }
      show_hide_answer();

      write_down_all_slides();
    </script>


  </body>
</html>
